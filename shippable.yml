language: java

jdk:
  - oraclejdk8

env:
  - secure: MpkoG+EqwfOX/tZWQ8QYijHWs/QoqQikA3lac20XFXJDzPpQTJqLhbmh03HMkvt6cDIZaeZHxPYjnqZWvK7LfWPZENa5T6QNaBQRHWZRUu6ej92ORn4/e1I6qK7MbMofmFNZyiGTFtV9819OSnjKpfaob6OFqFLARt3zh2JJ7UXszwo4kITvSRJfQVgzqA2TN/T+97KYj4I2ZatfTfi47sbo1SFjknkmrn227K/FIdfwADM95tM24bV4NHc8JpbWV837qZLLeS4eji4el/QrIOACubo1dy3henPKeC87IsJGaxmlY2ZILhAWX5McLjzHd/rut6nIiiU8Y5uW781bcg==

build:
  ci:
  - mkdir tmp
  - cp ext_lib/solver.gp tmp
  - cd tmp
  - gpg --output cplex.jar --yes --batch --decrypt --passphrase $UNZIP solver.gp
  - cd ..
  - mkdir artifacts
  - cd artifacts
  - git init
  - git remote add cardygan-mvn https://github.com/Echtzeitsysteme/cardygan-mvn.git
  - git pull cardygan-mvn master
  - cd ..
  - gradle publish -PcplexJarPath=$(pwd)/tmp/cplex.jar -x test
  - cd artifacts
  - git checkout --ours .
  - git add -u
  - git commit -m"updated release"
  - git push cardygan-mvn master
  - cd ..
  - rm -rf artifacts
  
  post-ci:
  - rm -rf tmp