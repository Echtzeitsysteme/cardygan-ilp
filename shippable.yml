language: java

jdk:
  - oraclejdk8

env:
  - secure: JCaleyxuX9ZeLbIm9XbF8KhMdlQgZMHnwzlkwOC1u3Ct2nfotl83AIXl/vVTt/ytv3gjZCxDRmwykKeVhmxc5/oqaGbJoBJ/Audj2PJgasLvzV3NdFrA6RjuuKuR/CkkNbOOeFnY9/NFVelKnZwBeNjB29Ah371PUlTerx79SAkNjdpefXtIweM++XNVOcRSopzCl9fF5JYGVIDsYYx7ypKWkjQIFyuZM/ricf5dzikt7wmpysdIDeUW/D965mGUmz9dC8dq2XrgFj/JgYnQ7jOaGjHLDH9rLu8s7NbGFHTVYBqqrUCawSCIX6IGTXbrFe9HA+0LYTQ864AdetSqHg==
  
build:
  ci:
  - mkdir tmp
  - cp ext_lib/solver.gp tmp
  - cd tmp
  - gpg --output cplex.jar --yes --batch --decrypt --passphrase $UNZIP solver.gp
  - cd ..
  - mkdir artifacts
  - cd artifacts
  - git init
  - git remote add cardygan-mvn $URL
  - git pull cardygan-mvn master
  - cd ..
  - gradle publish -PcplexJarPath=$(pwd)/tmp/cplex.jar -x test
  - cd artifacts
  - git checkout --ours .
  - git add -u
  - git commit -m"updated release"
  - git push cardygan-mvn master
  - cd ..
  - rm -rf artifacts
  
  post-ci:
  - rm -rf tmp